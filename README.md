Первая идея решения задания была:

1. создать базу данных
2. скидать туда все данные из логов
3. написать три запроса к базе и сохранить данные в csv

Попробовал использовать две базы данных: SQLite и MongoDB.

Но сразу же стали понятны проблемы этого решения:

+ Для SQLite: низкая скорость выполнения запросов,
+ для MongoDB: низкая скорость добавления записей в базу
(удалось добиться около 12000 добавлений/сек, что для файла в 27 млн. строк заняло бы порядка 30 мин.)

Однако этот метод может себя оправдать, если бы запросов было гораздо больше трех или,
если бы они происходили через какое-то время (тогда определенно нужно было бы где-то хранить данные),
или если бы данные постоянно обновлялись.

В связи с этим, пришлось использовать гораздо более простой метод:

1. сохранить данные в оперативной памяти в удобном виде
2. обработать их в соответствии с заданием и сохранить в csv

Сначало, мне казалось, что на это не хватит памяти, однако, для файла размером в 3Гб,
потребовалось около 400Мб RAM. Это вполне нормально, даже для домашнего компьютера.

Конечно, решение не претендует на самое лучшие и оптимальное по времени и памяти.